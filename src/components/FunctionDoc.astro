---
import CodeBlock from './CodeBlock.astro';

interface Props {
  name: string;
  description: string;
  code: string;
  params?: string;
  returns?: string;
  errors?: { code: string; text: string }[];
}

const { name, description, code, params, returns, errors } = Astro.props;
---

<div class="function-doc not-prose my-6 border border-[#e5e5e5] dark:border-[#333333] rounded-lg overflow-hidden">
  <div class="px-4 py-3 bg-[#f5f5f5] dark:bg-[#1a1a1a] border-b border-[#e5e5e5] dark:border-[#333333]">
    <h3 class="text-lg font-mono font-semibold text-black dark:text-white m-0">{name}</h3>
  </div>
  <div class="p-4 space-y-4">
    <p class="text-sm opacity-80 m-0">{description}</p>

    <CodeBlock code={code} />

    {(params || returns || errors) && (
      <div class="text-sm space-y-2 pt-2 border-t border-[#e5e5e5] dark:border-[#333333]">
        {params && (
          <p class="m-0">
            <span class="font-semibold text-black dark:text-white">Parameters:</span>
            <span class="opacity-70 ml-1" set:html={params} />
          </p>
        )}
        {returns && (
          <p class="m-0">
            <span class="font-semibold text-black dark:text-white">Returns:</span>
            <span class="opacity-70 ml-1" set:html={returns} />
          </p>
        )}
        {errors && errors.length > 0 && (
          <p class="m-0">
            <span class="font-semibold text-black dark:text-white">Errors:</span>
            {errors.map((err, i) => (
              <span class="opacity-70 ml-1">
                {i > 0 && ', '}
                <a href={`/errors/${err.code}`} class="underline hover:no-underline">{err.code}</a>
                {err.text && ` ${err.text}`}
              </span>
            ))}
          </p>
        )}
      </div>
    )}
  </div>
</div>
